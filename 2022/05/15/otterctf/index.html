<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>OtterCTF 内存取证 | H4cking to the Gate .</title><meta name="keywords" content="取证"><meta name="author" content="A.R."><meta name="copyright" content="A.R."><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="最近小小的学习了一下内存取证，装环境搞了整整一天，非常麻烦，在阅读相关资料时偶然看到了一篇WriteUp，是关于OtterCTF2018的十三道内存取证题目，用的全部是同一个镜像，考察的知识点非常全面，可以用来熟悉一下volatility的使用，关键是比赛平台居然还开着，正好当作内存取证的一次入门学习  What the password? 123456789101112131415161718┌">
<meta property="og:type" content="article">
<meta property="og:title" content="OtterCTF 内存取证">
<meta property="og:url" content="http://example.com/2022/05/15/otterctf/index.html">
<meta property="og:site_name" content="H4cking to the Gate .">
<meta property="og:description" content="最近小小的学习了一下内存取证，装环境搞了整整一天，非常麻烦，在阅读相关资料时偶然看到了一篇WriteUp，是关于OtterCTF2018的十三道内存取证题目，用的全部是同一个镜像，考察的知识点非常全面，可以用来熟悉一下volatility的使用，关键是比赛平台居然还开着，正好当作内存取证的一次入门学习  What the password? 123456789101112131415161718┌">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2022/06/06/MVU3yA5KrjLHpth.jpg">
<meta property="article:published_time" content="2022-05-15T07:19:39.000Z">
<meta property="article:modified_time" content="2022-06-05T18:37:36.918Z">
<meta property="article:author" content="A.R.">
<meta property="article:tag" content="取证">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/06/06/MVU3yA5KrjLHpth.jpg"><link rel="shortcut icon" href="https://s2.loli.net/2022/06/06/YSQAyaZPL4MhoCB.png"><link rel="canonical" href="http://example.com/2022/05/15/otterctf/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin=""/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/font-awesome/6.0.0/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://jsdelivr.pai233.top/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'OtterCTF 内存取证',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-06-06 02:37:36'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://s2.loli.net/2022/06/06/YSQAyaZPL4MhoCB.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2022/06/06/MVU3yA5KrjLHpth.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">H4cking to the Gate .</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/Gallery/"><i class="fa-fw fas fa-images"></i><span> 照片</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">OtterCTF 内存取证</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2022-05-15T07:19:39.000Z" title="发表于 2022-05-15 15:19:39">2022-05-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-06-05T18:37:36.918Z" title="更新于 2022-06-06 02:37:36">2022-06-06</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="OtterCTF 内存取证"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>最近小小的学习了一下内存取证，装环境搞了整整一天，非常麻烦，在阅读相关资料时偶然看到了一篇WriteUp，是关于<a target="_blank" rel="noopener" href="https://otterctf.com/challenges">OtterCTF2018</a>的十三道内存取证题目，用的全部是同一个镜像，考察的知识点非常全面，可以用来熟悉一下volatility的使用，关键是比赛平台居然还开着，正好当作内存取证的一次入门学习</p>
<hr>
<h1 id="What-the-password"><a href="#What-the-password" class="headerlink" title="What the password?"></a>What the password?</h1><p><img src="https://s2.loli.net/2022/06/06/BZr3HTiQya2N9qg.png" alt="img"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem imageinfo                  </span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">INFO    : volatility.debug    : Determining profile based on KDBG search...</span><br><span class="line">          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_24000, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_24000, Win7SP1x64_23418</span><br><span class="line">                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)</span><br><span class="line">                     AS Layer2 : FileAddressSpace (/root/桌面/OtterCTF.vmem)</span><br><span class="line">                      PAE type : No PAE</span><br><span class="line">                           DTB : 0x187000L</span><br><span class="line">                          KDBG : 0xf80002c430a0L</span><br><span class="line">          Number of Processors : 2</span><br><span class="line">     Image Type (Service Pack) : 1</span><br><span class="line">                KPCR for CPU 0 : 0xfffff80002c44d00L</span><br><span class="line">                KPCR for CPU 1 : 0xfffff880009ef000L</span><br><span class="line">             KUSER_SHARED_DATA : 0xfffff78000000000L</span><br><span class="line">           Image date and time : 2018-08-04 19:34:22 UTC+0000</span><br><span class="line">     Image local date and time : 2018-08-04 22:34:22 +0300</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>题目附件是一个raw文件，先用imageinfo查看一下镜像的信息，支持的系统有很多，我们可以试一试，指定profile为第一个Win7SP1x64，然后看看能否成功调用volshell</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 volshell</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Current context: System @ 0xfffffa8018d44740, pid=4, ppid=0 DTB=0x187000</span><br><span class="line">Welcome to volshell! Current memory image is:</span><br><span class="line">file:///root/%E6%A1%8C%E9%9D%A2/OtterCTF.vmem</span><br><span class="line">To get help, type &#x27;hh()&#x27;</span><br><span class="line"><span class="meta prompt_">&gt;</span><span class="language-bash">&gt;&gt; hh()</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>得到正确的镜像系统后，便可以在后面加上<code>--profile=Win7SP1x64</code>来使用后续的命令，第一题需要我们获取这个镜像的用户密码，可以使用hashdump，但得到密码都是哈希加密之后的，使用lsadump或者mimikatz可以得到明文</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 hashdump</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::</span><br><span class="line">Rick:1000:aad3b435b51404eeaad3b435b51404ee:518172d012f97d3a8fcc089615283940:::</span><br><span class="line">                                                                                                                         </span><br><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 lsadump </span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">DefaultPassword</span><br><span class="line">0x00000000  28 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   (...............</span><br><span class="line">0x00000010  4d 00 6f 00 72 00 74 00 79 00 49 00 73 00 52 00   M.o.r.t.y.I.s.R.</span><br><span class="line">0x00000020  65 00 61 00 6c 00 6c 00 79 00 41 00 6e 00 4f 00   e.a.l.l.y.A.n.O.</span><br><span class="line">0x00000030  74 00 74 00 65 00 72 00 00 00 00 00 00 00 00 00   t.t.e.r.........</span><br><span class="line"></span><br><span class="line">DPAPI_SYSTEM</span><br><span class="line">0x00000000  2c 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ,...............</span><br><span class="line">0x00000010  01 00 00 00 36 9b ba a9 55 e1 92 82 09 e0 63 4c   ....6...U.....cL</span><br><span class="line">0x00000020  20 74 63 14 9e d8 a0 4b 45 87 5a e4 bc f2 77 a5   .tc....KE.Z...w.</span><br><span class="line">0x00000030  25 3f 47 12 0b e5 4d a5 c8 35 cf dc 00 00 00 00   %?G...M..5......</span><br><span class="line"></span><br><span class="line">                                                                                                             </span><br><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 mimikatz</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Module   User             Domain           Password                                </span><br><span class="line">-------- ---------------- ---------------- ----------------------------------------</span><br><span class="line">wdigest  Rick             WIN-LO6FAF3DTFE  MortyIsReallyAnOtter                    </span><br><span class="line">wdigest  WIN-LO6FAF3DTFE$ WORKGROUP </span><br></pre></td></tr></table></figure>

<blockquote>
<p>CTF{MortyIsReallyAnOtter}</p>
</blockquote>
<h1 id="General-Info"><a href="#General-Info" class="headerlink" title="General Info"></a>General Info</h1><p><img src="https://s2.loli.net/2022/06/06/kVKzAInGFy1NSMx.png" alt="img"></p>
<p>第二题要获取主机名和ip地址</p>
<p><strong>ip地址</strong></p>
<p>能获取的ip地址的最快办法就是netscan，查看网络连接</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 netscan </span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Offset(P)          Proto    Local Address                  Foreign Address      State            Pid      Owner          Created</span><br><span class="line">0x7d60f010         UDPv4    0.0.0.0:1900                   *:*                                   2836     BitTorrent.exe 2018-08-04 19:27:17 UTC+0000</span><br><span class="line">0x7d62b3f0         UDPv4    192.168.202.131:6771           *:*                                   2836     BitTorrent.exe 2018-08-04 19:27:22 UTC+0000</span><br><span class="line">0x7d62f4c0         UDPv4    127.0.0.1:62307                *:*                                   2836     BitTorrent.exe 2018-08-04 19:27:17 UTC+0000</span><br><span class="line">0x7d62f920         UDPv4    192.168.202.131:62306          *:*                                   2836     BitTorrent.exe 2018-08-04 19:27:17 UTC+0000</span><br><span class="line">......</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p>netscan的结果很多，这里只放了一部分，期中多次出现的<code>192.168.202.131</code>就是ip地址</p>
<p><strong>主机名</strong></p>
<p>主机名的获取方法有两种，第一种是直接在hashdump的显示中可以看到主机名，第二种就是查注册表，这里使用hivelist查注册表</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 hivelist</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Virtual            Physical           Name</span><br><span class="line">------------------ ------------------ ----</span><br><span class="line">0xfffff8a00377d2d0 0x00000000624162d0 \??\C:\System Volume Information\Syscache.hve</span><br><span class="line">0xfffff8a00000f010 0x000000002d4c1010 [no name]</span><br><span class="line">0xfffff8a000024010 0x000000002d50c010 \REGISTRY\MACHINE\SYSTEM</span><br><span class="line">0xfffff8a000053320 0x000000002d5bb320 \REGISTRY\MACHINE\HARDWARE</span><br><span class="line">0xfffff8a000109410 0x0000000029cb4410 \SystemRoot\System32\Config\SECURITY</span><br><span class="line">0xfffff8a00033d410 0x000000002a958410 \Device\HarddiskVolume1\Boot\BCD</span><br><span class="line">0xfffff8a0005d5010 0x000000002a983010 \SystemRoot\System32\Config\SOFTWARE</span><br><span class="line">0xfffff8a001495010 0x0000000024912010 \SystemRoot\System32\Config\DEFAULT</span><br><span class="line">0xfffff8a0016d4010 0x00000000214e1010 \SystemRoot\System32\Config\SAM</span><br><span class="line">0xfffff8a00175b010 0x00000000211eb010 \??\C:\Windows\ServiceProfiles\NetworkService\NTUSER.DAT</span><br><span class="line">0xfffff8a00176e410 0x00000000206db410 \??\C:\Windows\ServiceProfiles\LocalService\NTUSER.DAT</span><br><span class="line">0xfffff8a002090010 0x000000000b92b010 \??\C:\Users\Rick\ntuser.dat</span><br><span class="line">0xfffff8a0020ad410 0x000000000db41410 \??\C:\Users\Rick\AppData\Local\Microsoft\Windows\UsrClass.dat</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>主机名信息在system的那一条记录中，再用<code>-o + 地址 printkey</code> 来查看指定的记录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 -o 0xfffff8a000024010 printkey</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Legend: (S) = Stable   (V) = Volatile</span><br><span class="line"></span><br><span class="line">----------------------------</span><br><span class="line">Registry: \REGISTRY\MACHINE\SYSTEM</span><br><span class="line">Key name: CMI-CreateHive&#123;2A7FB991-7BBE-4F9D-B91E-7CB51D4737F5&#125; (S)</span><br><span class="line">Last updated: 2018-08-04 19:25:54 UTC+0000</span><br><span class="line"></span><br><span class="line">Subkeys:</span><br><span class="line">  (S) ControlSet001</span><br><span class="line">  (S) ControlSet002</span><br><span class="line">  (S) MountedDevices</span><br><span class="line">  (S) RNG</span><br><span class="line">  (S) Select</span><br><span class="line">  (S) Setup</span><br><span class="line">  (S) Software</span><br><span class="line">  (S) WPA</span><br><span class="line">  (V) CurrentControlSet</span><br><span class="line"></span><br><span class="line">Values:</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>跟进ControlSet001，一路到最后可以看到主机名的value</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 -o 0xfffff8a000024010 printkey -K &quot;ControlSet001\Control\ComputerName\ComputerName&quot;</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Legend: (S) = Stable   (V) = Volatile</span><br><span class="line"></span><br><span class="line">----------------------------</span><br><span class="line">Registry: \REGISTRY\MACHINE\SYSTEM</span><br><span class="line">Key name: ComputerName (S)</span><br><span class="line">Last updated: 2018-06-02 19:23:00 UTC+0000</span><br><span class="line"></span><br><span class="line">Subkeys:</span><br><span class="line"></span><br><span class="line">Values:</span><br><span class="line">REG_SZ                        : (S) mnmsrvc</span><br><span class="line">REG_SZ        ComputerName    : (S) WIN-LO6FAF3DTFE</span><br></pre></td></tr></table></figure>

<blockquote>
<p>CTF{192.168.202.131}</p>
<p>CTF{WIN-LO6FAF3DTFE}</p>
</blockquote>
<h1 id="Play-Time"><a href="#Play-Time" class="headerlink" title="Play Time"></a>Play Time</h1><p><img src="https://s2.loli.net/2022/06/06/dtfg2PaKbTywxvG.png" alt="img"></p>
<p>要找到他玩的游戏，可以用pslist来看看进程，看ip地址可以用netscan</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 pslist</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Offset(V)          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit                          </span><br><span class="line">------------------ -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------</span><br><span class="line">0xfffffa8018d44740 System                    4      0     95      411 ------      0 2018-08-04 19:26:03 UTC+0000                                 </span><br><span class="line">0xfffffa801947e4d0 smss.exe                260      4      2       30 ------      0 2018-08-04 19:26:03 UTC+0000                                 </span><br><span class="line">0xfffffa801a0c8380 csrss.exe               348    336      9      563      0      0 2018-08-04 19:26:10 UTC+0000                                                                                             </span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">0xfffffa801b4a7b30 bittorrentie.e         2308   2836     15      337      1      1 2018-08-04 19:27:19 UTC+0000                                 </span><br><span class="line">0xfffffa801b4c9b30 bittorrentie.e         2624   2836     13      316      1      1 2018-08-04 19:27:21 UTC+0000                                 </span><br><span class="line">0xfffffa801b5cb740 LunarMS.exe             708   2728     18      346      1      1 2018-08-04 19:27:39 UTC+0000                                 </span><br><span class="line">0xfffffa801988c2d0 PresentationFo          724    492      6      148      0      0 2018-08-04 19:27:52 UTC+0000                                                                 </span><br><span class="line">......</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p>其中有个进程LunarMS.exe，可以谷歌搜索一下，发现是个游戏，顺势用netscan查出ip地址</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 netscan|grep LunarMS</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">0x7d6124d0         TCPv4    192.168.202.131:49530          77.102.199.102:7575  CLOSED           708      LunarMS.exe    </span><br><span class="line">0x7e413a40         TCPv4    -:0                            -:0                  CLOSED           708      LunarMS.exe    </span><br><span class="line">0x7e521b50         TCPv4    -:0                            -:0                  CLOSED           708      LunarMS.exe</span><br></pre></td></tr></table></figure>

<blockquote>
<p>CTF{LunarMS}</p>
<p>CTF{77.102.199.102}</p>
</blockquote>
<h1 id="Name-Game"><a href="#Name-Game" class="headerlink" title="Name Game"></a>Name Game</h1><p><img src="https://s2.loli.net/2022/06/06/9BqVQaOvKG12cIR.png" alt="img"></p>
<p>要找到Lunar-3这个服上的用户名，我们最好把进程给dump下来进行逆向分析，这里也可以在镜像中通过寻找字符串的方式找到和Lunar-3相关记录</p>
<p>这里可以使用工具010editor</p>
<p><img src="https://s2.loli.net/2022/06/06/KSWdo9GJ5w4P8sC.png" alt="img"></p>
<p>可以看到Lunar-3的后面有一个奇怪的字符串<code>0tt3r8r33z3</code>，这个就是用户名</p>
<p>或者也可以在命令行中直接查找</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# strings /root/桌面/OtterCTF.vmem|grep Lunar-3 -C 5 </span><br><span class="line">.&gt;SWqn</span><br><span class="line">Y!F[Wq</span><br><span class="line">disabled</span><br><span class="line">mouseOver</span><br><span class="line">keyFocused</span><br><span class="line">Lunar-3</span><br><span class="line">0tt3r8r33z3</span><br><span class="line">Sound/UI.img/</span><br><span class="line">BtMouseClick</span><br><span class="line">Lunar-4</span><br><span class="line">Lunar-1</span><br><span class="line">--</span><br><span class="line">c+Y\</span><br><span class="line">\b+Y</span><br><span class="line">c+Yt</span><br><span class="line">tb+Y4c+Y</span><br><span class="line">b+YLc+Y</span><br><span class="line">Lunar-3</span><br><span class="line">Lunar-4</span><br><span class="line">L(dNVxdNV</span><br><span class="line">L|eNV</span><br><span class="line">&#123;qf8</span><br><span class="line">q r&quot;r r</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<p>这里使用strings命令加上grep搜索，<code>-C 5</code>表示查找前后5条记录，同样可以找到可疑字符串</p>
<blockquote>
<p>CTF{0tt3r8r33z3}</p>
</blockquote>
<h1 id="Name-Game-2"><a href="#Name-Game-2" class="headerlink" title="Name Game 2"></a>Name Game 2</h1><p><img src="https://s2.loli.net/2022/06/06/RWjCFQLVHYN17P3.png" alt="img"></p>
<p>这里先用memdump把前面那个LunarMS.exe游戏进程打印出来，进程号PID可以看前面的pslist</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 memdump -p 708 -D ./</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">************************************************************************</span><br><span class="line">Writing LunarMS.exe [   708] to 708.dmp</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<p>这个题给了一个16进制的签名，我们用010来搜索其中的片段<code>5A 0C 00</code>，结果非常多，得慢慢找，可以看到这个M0rtyL0L就是角色名</p>
<p><img src="https://s2.loli.net/2022/06/06/RkV45bhpmnXHI1S.png" alt="img"></p>
<p>用hexdump命令也可以查找，结果就不放了，太长了</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexdump -C 708.dmp |grep <span class="string">&quot;5a 0c 00&quot;</span> -A 3 -B 3</span><br></pre></td></tr></table></figure>

<blockquote>
<p>CTF{M0rtyL0L}</p>
</blockquote>
<h1 id="Silly-Rick"><a href="#Silly-Rick" class="headerlink" title="Silly Rick"></a>Silly Rick</h1><p><img src="https://s2.loli.net/2022/06/06/XpQfvtNCa8xPWVU.png" alt="img"></p>
<p>题目需要获得邮箱密码，又提示说经常复制粘贴，那我们可以用clipboard查看剪贴板</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 clipboard</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Session    WindowStation Format                         Handle Object             Data                                              </span><br><span class="line">---------- ------------- ------------------ ------------------ ------------------ --------------------------------------------------</span><br><span class="line">         1 WinSta0       CF_UNICODETEXT                0x602e3 0xfffff900c1ad93f0 M@il_Pr0vid0rs                                    </span><br><span class="line">         1 WinSta0       CF_TEXT                          0x10 ------------------                                                   </span><br><span class="line">         1 WinSta0       0x150133L              0x200000000000 ------------------                                                   </span><br><span class="line">         1 WinSta0       CF_TEXT                           0x1 ------------------                                                   </span><br><span class="line">         1 ------------- ------------------           0x150133 0xfffff900c1c1adc0          </span><br><span class="line">         </span><br></pre></td></tr></table></figure>

<blockquote>
<p>CTF{M@il_Pr0vid0rs}</p>
</blockquote>
<h1 id="Hide-And-Seek"><a href="#Hide-And-Seek" class="headerlink" title="Hide And Seek"></a>Hide And Seek</h1><p><img src="https://s2.loli.net/2022/06/06/7GgWc5UVDl8m6H1.png" alt="img"></p>
<p>这个题目要找到恶意进程名字，我们可以用pstree查看进程树</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 pstree    </span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Name                                                  Pid   PPid   Thds   Hnds Time</span><br><span class="line">-------------------------------------------------- ------ ------ ------ ------ ----</span><br><span class="line"> 0xfffffa801b27e060:explorer.exe                     2728   2696     33    854 2018-08-04 19:27:04 UTC+0000</span><br><span class="line">. 0xfffffa801b486b30:Rick And Morty                  3820   2728      4    185 2018-08-04 19:32:55 UTC+0000</span><br><span class="line">.. 0xfffffa801a4c5b30:vmware-tray.ex                 3720   3820      8    147 2018-08-04 19:33:02 UTC+0000</span><br><span class="line">. 0xfffffa801b2f02e0:WebCompanion.e                  2844   2728      0 ------ 2018-08-04 19:27:07 UTC+0000</span><br><span class="line">. 0xfffffa801a4e3870:chrome.exe                      4076   2728     44   1160 2018-08-04 19:29:30 UTC+0000</span><br><span class="line">.. 0xfffffa801a4eab30:chrome.exe                     4084   4076      8     86 2018-08-04 19:29:30 UTC+0000</span><br><span class="line">.. 0xfffffa801a5ef1f0:chrome.exe                     1796   4076     15    170 2018-08-04 19:33:41 UTC+0000</span><br><span class="line">.. 0xfffffa801aa00a90:chrome.exe                     3924   4076     16    228 2018-08-04 19:29:51 UTC+0000</span><br><span class="line">.. 0xfffffa801a635240:chrome.exe                     3648   4076     16    207 2018-08-04 19:33:38 UTC+0000</span><br><span class="line">.. 0xfffffa801a502b30:chrome.exe                      576   4076      2     58 2018-08-04 19:29:31 UTC+0000</span><br><span class="line">.. 0xfffffa801a4f7b30:chrome.exe                     1808   4076     13    229 2018-08-04 19:29:32 UTC+0000</span><br><span class="line">.. 0xfffffa801a7f98f0:chrome.exe                     2748   4076     15    181 2018-08-04 19:31:15 UTC+0000</span><br><span class="line">. 0xfffffa801b5cb740:LunarMS.exe                      708   2728     18    346 2018-08-04 19:27:39 UTC+0000</span><br><span class="line">. 0xfffffa801b1cdb30:vmtoolsd.exe                    2804   2728      6    190 2018-08-04 19:27:06 UTC+0000</span><br><span class="line">. 0xfffffa801b290b30:BitTorrent.exe                  2836   2728     24    471 2018-08-04 19:27:07 UTC+0000</span><br><span class="line">.. 0xfffffa801b4c9b30:bittorrentie.e                 2624   2836     13    316 2018-08-04 19:27:21 UTC+0000</span><br><span class="line">.. 0xfffffa801b4a7b30:bittorrentie.e                 2308   2836     15    337 2018-08-04 19:27:19 UTC+0000</span><br><span class="line"> 0xfffffa8018d44740:System                              4      0     95    411 2018-08-04 19:26:03 UTC+0000</span><br><span class="line">. 0xfffffa801947e4d0:smss.exe                         260      4      2     30 2018-08-04 19:26:03 UTC+0000</span><br><span class="line"> 0xfffffa801a2ed060:wininit.exe                       396    336      3     78 2018-08-04 19:26:11 UTC+0000</span><br><span class="line">. 0xfffffa801ab377c0:services.exe                     492    396     11    242 2018-08-04 19:26:12 UTC+0000</span><br><span class="line">.. 0xfffffa801afe7800:svchost.exe                    1948    492      6     96 2018-08-04 19:26:42 UTC+0000</span><br><span class="line">.. 0xfffffa801ae92920:vmtoolsd.exe                   1428    492      9    313 2018-08-04 19:26:27 UTC+0000</span><br><span class="line">... 0xfffffa801a572b30:cmd.exe                       3916   1428      0 ------ 2018-08-04 19:34:22 UTC+0000</span><br><span class="line">.. 0xfffffa801ae0f630:VGAuthService.                 1356    492      3     85 2018-08-04 19:26:25 UTC+0000</span><br><span class="line">.. 0xfffffa801abbdb30:vmacthlp.exe                    668    492      3     56 2018-08-04 19:26:16 UTC+0000</span><br><span class="line">.. 0xfffffa801aad1060:Lavasoft.WCAss                 3496    492     14    473 2018-08-04 19:33:49 UTC+0000</span><br><span class="line">.. 0xfffffa801a6af9f0:svchost.exe                     164    492     12    147 2018-08-04 19:28:42 UTC+0000</span><br><span class="line">.. 0xfffffa801ac2e9e0:svchost.exe                     808    492     22    508 2018-08-04 19:26:18 UTC+0000</span><br><span class="line">... 0xfffffa801ac753a0:audiodg.exe                    960    808      7    151 2018-08-04 19:26:19 UTC+0000</span><br><span class="line">.. 0xfffffa801ae7f630:dllhost.exe                    1324    492     15    207 2018-08-04 19:26:42 UTC+0000</span><br><span class="line">.. 0xfffffa801a6c2700:mscorsvw.exe                   3124    492      7     77 2018-08-04 19:28:43 UTC+0000</span><br><span class="line">.. 0xfffffa801b232060:sppsvc.exe                     2500    492      4    149 2018-08-04 19:26:58 UTC+0000</span><br><span class="line">.. 0xfffffa801abebb30:svchost.exe                     712    492      8    301 2018-08-04 19:26:17 UTC+0000</span><br><span class="line">.. 0xfffffa801ad718a0:svchost.exe                    1164    492     18    312 2018-08-04 19:26:23 UTC+0000</span><br><span class="line">.. 0xfffffa801ac31b30:svchost.exe                     844    492     17    396 2018-08-04 19:26:18 UTC+0000</span><br><span class="line">... 0xfffffa801b1fab30:dwm.exe                       2704    844      4     97 2018-08-04 19:27:04 UTC+0000</span><br><span class="line">.. 0xfffffa801988c2d0:PresentationFo                  724    492      6    148 2018-08-04 19:27:52 UTC+0000</span><br><span class="line">.. 0xfffffa801b603610:mscorsvw.exe                    412    492      7     86 2018-08-04 19:28:42 UTC+0000</span><br><span class="line">.. 0xfffffa8018e3c890:svchost.exe                     604    492     11    376 2018-08-04 19:26:16 UTC+0000</span><br><span class="line">... 0xfffffa8019124b30:WmiPrvSE.exe                  1800    604      9    222 2018-08-04 19:26:39 UTC+0000</span><br><span class="line">... 0xfffffa801b112060:WmiPrvSE.exe                  2136    604     12    324 2018-08-04 19:26:51 UTC+0000</span><br><span class="line">.. 0xfffffa801ad5ab30:spoolsv.exe                    1120    492     14    346 2018-08-04 19:26:22 UTC+0000</span><br><span class="line">.. 0xfffffa801ac4db30:svchost.exe                     868    492     45   1114 2018-08-04 19:26:18 UTC+0000</span><br><span class="line">.. 0xfffffa801a6e4b30:svchost.exe                    3196    492     14    352 2018-08-04 19:28:44 UTC+0000</span><br><span class="line">.. 0xfffffa801acd37e0:svchost.exe                     620    492     19    415 2018-08-04 19:26:21 UTC+0000</span><br><span class="line">.. 0xfffffa801b1e9b30:taskhost.exe                   2344    492      8    193 2018-08-04 19:26:57 UTC+0000</span><br><span class="line">.. 0xfffffa801ac97060:svchost.exe                    1012    492     12    554 2018-08-04 19:26:20 UTC+0000</span><br><span class="line">.. 0xfffffa801b3aab30:SearchIndexer.                 3064    492     11    610 2018-08-04 19:27:14 UTC+0000</span><br><span class="line">.. 0xfffffa801aff3b30:msdtc.exe                      1436    492     14    155 2018-08-04 19:26:43 UTC+0000</span><br><span class="line">. 0xfffffa801ab3f060:lsass.exe                        500    396      7    610 2018-08-04 19:26:12 UTC+0000</span><br><span class="line">. 0xfffffa801ab461a0:lsm.exe                          508    396     10    148 2018-08-04 19:26:12 UTC+0000</span><br><span class="line"> 0xfffffa801a0c8380:csrss.exe                         348    336      9    563 2018-08-04 19:26:10 UTC+0000</span><br><span class="line">. 0xfffffa801a6643d0:conhost.exe                     2420    348      0     30 2018-08-04 19:34:22 UTC+0000</span><br><span class="line"> 0xfffffa80198d3b30:csrss.exe                         388    380     11    460 2018-08-04 19:26:11 UTC+0000</span><br><span class="line"> 0xfffffa801aaf4060:winlogon.exe                      432    380      3    113 2018-08-04 19:26:11 UTC+0000</span><br><span class="line"> 0xfffffa801b18f060:WebCompanionIn                   3880   1484     15    522 2018-08-04 19:33:07 UTC+0000</span><br><span class="line">. 0xfffffa801aa72b30:sc.exe                          3504   3880      0 ------ 2018-08-04 19:33:48 UTC+0000</span><br><span class="line">. 0xfffffa801aeb6890:sc.exe                           452   3880      0 ------ 2018-08-04 19:33:48 UTC+0000</span><br><span class="line">. 0xfffffa801a6268b0:WebCompanion.e                  3856   3880     15    386 2018-08-04 19:34:05 UTC+0000</span><br><span class="line">. 0xfffffa801b08f060:sc.exe                          3208   3880      0 ------ 2018-08-04 19:33:47 UTC+0000</span><br><span class="line">. 0xfffffa801ac01060:sc.exe                          2028   3880      0 ------ 2018-08-04 19:33:49 UTC+0000</span><br><span class="line"> 0xfffffa801b1fd960:notepad.exe                      3304   3132      2     79 2018-08-04 19:34:10 UTC+0000</span><br><span class="line">                </span><br></pre></td></tr></table></figure>

<p>其中有个很奇怪的vmware-tray.exe居然是Rick And Morty的子进程，非常奇怪，</p>
<p>可以用dlllist查看一下进程相关的dll文件列表</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 dlllist -p 3720 </span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">************************************************************************</span><br><span class="line">vmware-tray.ex pid:   3720</span><br><span class="line">Command line : &quot;C:\Users\Rick\AppData\Local\Temp\RarSFX0\vmware-tray.exe&quot; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Base                             Size          LoadCount LoadTime                       Path</span><br><span class="line">------------------ ------------------ ------------------ ------------------------------ ----</span><br><span class="line">0x0000000000ec0000            0x6e000             0xffff 1970-01-01 00:00:00 UTC+0000   C:\Users\Rick\AppData\Local\Temp\RarSFX0\vmware-tray.exe</span><br><span class="line">0x00000000776f0000           0x1a9000             0xffff 1970-01-01 00:00:00 UTC+0000   C:\Windows\SYSTEM32\ntdll.dll</span><br><span class="line">0x0000000075210000            0x3f000                0x3 2018-08-04 19:33:03 UTC+0000   C:\Windows\SYSTEM32\wow64.dll</span><br><span class="line">0x00000000751b0000            0x5c000                0x1 2018-08-04 19:33:03 UTC+0000   C:\Windows\SYSTEM32\wow64win.dll</span><br><span class="line">0x00000000751a0000             0x8000                0x1 2018-08-04 19:33:03 UTC+0000   C:\Windows\SYSTEM32\wow64cpu.dll</span><br><span class="line">0x0000000000ec0000            0x6e000             0xffff 1970-01-01 00:00:00 UTC+0000   C:\Users\Rick\AppData\Local\Temp\RarSFX0\vmware-tray.exe</span><br><span class="line">0x00000000778d0000           0x180000             0xffff 1970-01-01 00:00:00 UTC+0000   C:\Windows\SysWOW64\ntdll.dll</span><br><span class="line">......</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p>这个进程的执行目录是temp，一看就不是正经程序</p>
<blockquote>
<p>CTF{vmware-tray.exe}</p>
</blockquote>
<h1 id="Path-To-Glory"><a href="#Path-To-Glory" class="headerlink" title="Path To Glory"></a>Path To Glory</h1><p><img src="https://s2.loli.net/2022/06/06/Wbv4aLKAZXSDRUy.png" alt="img"></p>
<p>这个题目有点意义不明，不明确flag内容到底应该是什么</p>
<p>由于上一题了解到，恶意进程的父进程是Rick And Morty，那么先用filescan找一找这个文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 filescan|grep &#x27;Rick And Morty&#x27;</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">0x000000007d63dbc0     10      0 R--r-d \Device\HarddiskVolume1\Torrents\Rick And Morty season 1 download.exe</span><br><span class="line">0x000000007d8813c0      2      0 RW-rwd \Device\HarddiskVolume1\Users\Rick\Downloads\Rick And Morty season 1 download.exe.torrent</span><br><span class="line">0x000000007da56240      2      0 RW-rwd \Device\HarddiskVolume1\Torrents\Rick And Morty season 1 download.exe</span><br><span class="line">0x000000007dae9350      2      0 RWD--- \Device\HarddiskVolume1\Users\Rick\AppData\Roaming\BitTorrent\Rick And Morty season 1 download.exe.1.torrent</span><br><span class="line">0x000000007dcbf6f0      2      0 RW-rwd \Device\HarddiskVolume1\Users\Rick\AppData\Roaming\BitTorrent\Rick And Morty season 1 download.exe.1.torrent</span><br><span class="line">0x000000007e710070      8      0 R--rwd \Device\HarddiskVolume1\Torrents\Rick And Morty season 1 download.exe</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<p>一共6个文件，其中有三个exe和三个种子文件，我们要分析来源就要关注种子文件，里面可能放着地址信息</p>
<p>先用dumpfiles转储文件，-Q指定内存地址，把三个种子都拿出来分析</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 dumpfiles -Q 0x000000007d8813c0 -D ./</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">DataSectionObject 0x7d8813c0   None   \Device\HarddiskVolume1\Users\Rick\Downloads\Rick And Morty season 1 download.exe.torrent</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# strings file.None.0xfffffa801af10010.dat</span><br><span class="line">[ZoneTransfer]</span><br><span class="line">ZoneId=3</span><br><span class="line">                                                                                                                               </span><br><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# strings file.None.0xfffffa801b42c9e0.dat </span><br><span class="line">d8:announce44:udp://tracker.openbittorrent.com:80/announce13:announce-listll44:udp://tracker.openbittorrent.com:80/announceel42:udp://tracker.opentrackr.org:1337/announceee10:created by17:BitTorrent/7.10.313:creation datei1533150595e8:encoding5:UTF-84:infod6:lengthi456670e4:name36:Rick And Morty season 1 download.exe12:piece lengthi16384e6:pieces560:\I</span><br><span class="line">!PC&lt;^X</span><br><span class="line">B.k_Rk</span><br><span class="line">0&lt;;O87o</span><br><span class="line">!4^&quot;</span><br><span class="line">3hq,</span><br><span class="line">&amp;iW1|</span><br><span class="line">K68:o</span><br><span class="line">w~Q~YT</span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash"><span class="variable">$o9p</span></span></span><br><span class="line">bwF:u</span><br><span class="line">e7:website19:M3an_T0rren7_4_R!cke</span><br><span class="line">                                                                                                                               </span><br><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# strings file.None.0xfffffa801b51ccf0.dat </span><br><span class="line">[ZoneTransfer]</span><br><span class="line">ZoneId=3</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<p>第二个种子文件中有个website字段M3an_T0rren7_4_R!cke非常可疑</p>
<p>当作答案提交一下，结果错了，最后上网发现末尾的e是没有的，我也不知道为啥</p>
<blockquote>
<p>CTF{M3an_T0rren7_4_R!ck}</p>
</blockquote>
<h1 id="Path-To-Glory-2"><a href="#Path-To-Glory-2" class="headerlink" title="Path To Glory 2"></a>Path To Glory 2</h1><p><img src="https://s2.loli.net/2022/06/06/RFMDy4O3GKzE8Am.png" alt="img"></p>
<p>这个题目更迷了，猜不透让我交啥，这里我看了一下网上办法</p>
<p>先把所有的chrome浏览器进程转储下来，</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 memdump -n chrome.exe  -D ./chrome</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">************************************************************************</span><br><span class="line">Writing chrome.exe [  4076] to 4076.dmp</span><br><span class="line">************************************************************************</span><br><span class="line">Writing chrome.exe [  4084] to 4084.dmp</span><br><span class="line">************************************************************************</span><br><span class="line">Writing chrome.exe [   576] to 576.dmp</span><br><span class="line">************************************************************************</span><br><span class="line">Writing chrome.exe [  1808] to 1808.dmp</span><br><span class="line">************************************************************************</span><br><span class="line">Writing chrome.exe [  3924] to 3924.dmp</span><br><span class="line">************************************************************************</span><br><span class="line">Writing chrome.exe [  2748] to 2748.dmp</span><br><span class="line">************************************************************************</span><br><span class="line">Writing chrome.exe [  3648] to 3648.dmp</span><br><span class="line">************************************************************************</span><br><span class="line">Writing chrome.exe [  1796] to 1796.dmp</span><br><span class="line">  </span><br></pre></td></tr></table></figure>

<p>再看看有没有和Rick And Morty相关的信息</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# strings ./chrome/* | grep &#x27;Rick And Morty season 1 download.exe&#x27; -C 10</span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">--</span><br><span class="line">wCachePathe</span><br><span class="line">.CachePrefix</span><br><span class="line">CacheLimite</span><br><span class="line">CacheOptions</span><br><span class="line">CacheRepair</span><br><span class="line">GOOGLE~1.LNK</span><br><span class="line">MAPLES~1.URL</span><br><span class="line">BITTOR~1.LNK</span><br><span class="line">Flag.txt</span><br><span class="line">Flag.txt</span><br><span class="line">Rick And Morty season 1 download.exe.lnk</span><br><span class="line">Rick And Morty season 1 download.exe.lnk</span><br><span class="line">.WINDOWS</span><br><span class="line">OpenWithListp</span><br><span class="line">&#123;1NP14R77-02R7-4R5Q-O744-2RO1NR5198O7&#125;\ehaqyy32.rkr</span><br><span class="line">MRUList</span><br><span class="line">.WINDOWS</span><br><span class="line">.tor</span><br><span class="line">.txt</span><br><span class="line">.WIN</span><br><span class="line">.ziphx</span><br><span class="line">Foldv</span><br><span class="line">--</span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">--</span><br><span class="line">display:inline;width:56px;height:200px;m&gt;</span><br><span class="line">Hum@n_I5_Th3_Weak3s7_Link_In_Th3_Ch@inYear</span><br><span class="line">//sec-s.uicdn.com/nav-cdn/home/preloader.gif</span><br><span class="line">simple-icon_toolbar-change-view-horizontal</span><br><span class="line"> nnx-track-sec-click-communication-inboxic.com</span><br><span class="line">nx-track-sec-click-dashboard-hide_smileyable</span><br><span class="line">Nftd-box stem-north big fullsize js-focusable</span><br><span class="line">js-box-flex need-overlay js-componentone</span><br><span class="line">Jhttps://search.mail.com/web [q origin ]Year</span><br><span class="line">ntrack-and-trace__delivery-info--has-iconf</span><br><span class="line">Rick And Morty season 1 download.exe.torrent</span><br><span class="line">tbl_1533411035475_7.0.1.40728_2033115181</span><br><span class="line">panel-mail-display-table-mail-default35&quot;</span><br><span class="line">Cnpanel-mail-display-table-mail-horizontal.js</span><br><span class="line">trc_rbox text-links-a trc-content-sponsored </span><br><span class="line">identity_OjpwcmVsb2FkZXIuaHRtbC50d2ln</span><br><span class="line">Move the widget to its desired position.3c8=</span><br><span class="line">Set-Cookie, no-store, proxy-revalidateHxRKw=</span><br><span class="line">Set-Cookie, no-store, proxy-revalidate143/</span><br><span class="line">tbl_1533411035475_7.0.9.40728_2033115181</span><br><span class="line">&quot;mail.com Update&quot; &lt;service@corp.mail.com&gt;e</span><br><span class="line">......</span><br><span class="line">......</span><br></pre></td></tr></table></figure>

<p>找到的结果中<code>Hum@n_I5_Th3_Weak3s7_Link_In_Th3_Ch@in</code>即为flag，然后结果中意外的发现了flag.txt，后面会用到</p>
<blockquote>
<p>CTF{Hum@n_I5_Th3_Weak3s7_Link_In_Th3_Ch@in}</p>
</blockquote>
<h1 id="Bit-4-Bit"><a href="#Bit-4-Bit" class="headerlink" title="Bit 4 Bit"></a>Bit 4 Bit</h1><p><img src="https://s2.loli.net/2022/06/06/k4lOQVTBC2p3wSK.png" alt="img"></p>
<p>题目告诉我们这个恶意进程是一个勒索软件，要我们找出攻击者的比特币账户地址，那我们肯定是要先把恶意软件dump下来</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 procdump -p 3720  -D ./</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">Process(V)         ImageBase          Name                 Result</span><br><span class="line">------------------ ------------------ -------------------- ------</span><br><span class="line">0xfffffa801a4c5b30 0x0000000000ec0000 vmware-tray.ex       OK: executable.3720.exe</span><br><span class="line">              </span><br></pre></td></tr></table></figure>

<p>接下来就是用dnspy进行逆向分析（直接看伪代码）</p>
<p><img src="https://s2.loli.net/2022/06/06/BXgaGK6yqkZY2UH.png" alt="img"></p>
<p>在form3中可以看到这个软件的显示的信息，直接把address写出来了</p>
<blockquote>
<p>CTF{1MmpEmebJkqXG8nQv4cjJSmxZQFVmFo63M}</p>
</blockquote>
<h1 id="Graphic’s-For-The-Weak"><a href="#Graphic’s-For-The-Weak" class="headerlink" title="Graphic’s For The Weak"></a>Graphic’s For The Weak</h1><p><img src="https://s2.loli.net/2022/06/06/hxLA4GRpJ7EKQl9.png" alt="img"></p>
<p>要找到图片的隐藏信息，那就继续分析，在资源中查看图片，直接可以看到隐藏信息</p>
<p><img src="https://s2.loli.net/2022/06/06/p5Cj9JOhqylLtXz.png" alt="img"></p>
<blockquote>
<p>CTF{S0_Just_M0v3_Socy}</p>
</blockquote>
<h1 id="Recovery"><a href="#Recovery" class="headerlink" title="Recovery"></a>Recovery</h1><p><img src="https://s2.loli.net/2022/06/06/NqHuRQfCoAxcgle.png" alt="img"></p>
<p>这一题就是找出加密文件所使用的密码</p>
<p><img src="https://s2.loli.net/2022/06/06/Wm9LFtYje8MVvxA.png" alt="img"></p>
<p>分析exe可以看到两个函数，第一个创建密码是随机的，然后有一个发送密码，是把computerName和userName还有password拼接以后进行发送</p>
<p>可以分析出compuerName就是WIN-LO6FAF3DTFE，用户名是Rick，所以这个函数发送的字符串应该是<code>WIN-LO6FAF3DTFE-Rick password</code>，我们直接去这个勒索软件的内存中寻找相关字符串即可</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# strings -el ./3720.dmp | grep &#x27;WIN-LO6FAF3DTFE-Rick&#x27; -C 5 </span><br><span class="line">\Desktop\</span><br><span class="line">abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890*!=&amp;?&amp;/</span><br><span class="line">aDOBofVYUNVnmp7</span><br><span class="line">aDOBofVYUNVnmp7</span><br><span class="line">C:\Users\Rick\Desktop\</span><br><span class="line">WIN-LO6FAF3DTFE-Rick aDOBofVYUNVnmp7</span><br><span class="line">.txt</span><br><span class="line">.doc</span><br><span class="line">.docx</span><br><span class="line">.xls</span><br><span class="line">.xlsx</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<p>-el参数的e指定了字符编码，l为小端编码，如果想用大端就是-eb</p>
<p>这里搜索到的<code>aDOBofVYUNVnmp7</code>就是password</p>
<blockquote>
<p>CTF{aDOBofVYUNVnmp7}</p>
</blockquote>
<h1 id="Closure"><a href="#Closure" class="headerlink" title="Closure"></a>Closure</h1><p><img src="https://s2.loli.net/2022/06/06/isuTOVKZvbMzJHB.png" alt="img"></p>
<p>最后一题要解密文件，容易想到前面提到的flag文件，这个flag文件应该是被加密过的，但我们已经知道密码了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 filescan|grep -i &#x27;flag&#x27;</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">0x000000007d61b070     16      0 RW-rw- \Device\HarddiskVolume1\Users\Rick\AppData\Roaming\Microsoft\Windows\Recent\Flag.txt.WINDOWS.lnk</span><br><span class="line">0x000000007e410890     16      0 R--r-- \Device\HarddiskVolume1\Users\Rick\Desktop\Flag.txt</span><br><span class="line">                                                                                         </span><br><span class="line">┌──(root㉿kali2022)-[~]</span><br><span class="line">└─# vol.py -f /root/桌面/OtterCTF.vmem --profile=Win7SP1x64 dumpfiles -Q 0x000000007e410890 -D ./</span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">DataSectionObject 0x7e410890   None   \Device\HarddiskVolume1\Users\Rick\Desktop\Flag.txt</span><br><span class="line"> </span><br></pre></td></tr></table></figure>

<p>先找到flag文件，并且转储下来</p>
<p><strong>解密过程</strong></p>
<p>已知这个勒索软件为HiddenTear，直接在网上找到解密程序HiddenTearDecrypter</p>
<p>先将加密文件的末尾多余的0去掉，再把后缀加上locked</p>
<p><img src="https://s2.loli.net/2022/06/06/2dspvnHAlErat97.png" alt="img"></p>
<p>拿去解密，密钥已经知道了，直接输入</p>
<p><img src="https://s2.loli.net/2022/06/06/zlAvDP6SVfc37ea.png" alt="img"></p>
<p><img src="https://s2.loli.net/2022/06/06/dPUVHQtRc2xbWMT.png" alt="img"></p>
<blockquote>
<p>CTF{Im_Th@_B3S7_RicK_0f_Th3m_4ll}</p>
</blockquote>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://example.com">A.R.</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2022/05/15/otterctf/">http://example.com/2022/05/15/otterctf/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">H4cking to the Gate .</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%8F%96%E8%AF%81/">取证</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2022/06/06/MVU3yA5KrjLHpth.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://jsdelivr.pai233.top/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://jsdelivr.pai233.top/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/05/30/CISCN2022/"><img class="prev-cover" src="https://s2.loli.net/2022/06/06/NRPCUlQtxn7BzAc.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">CISCN2022 初赛</div></div></a></div><div class="next-post pull-right"><a href="/2022/05/13/pwnhub5/"><img class="next-cover" src="https://s2.loli.net/2022/06/06/Pszmq3Fd6QyGNlj.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">PWNHUB 5月公开赛 Web</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://s2.loli.net/2022/06/06/YSQAyaZPL4MhoCB.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">A.R.</div><div class="author-info__description">岁月长，衣衫薄</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">31</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">17</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">0</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://h4cking2thegate.github.io/"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/H4cking2theGate" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:1416930186@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">El Psy Congroo !</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#What-the-password"><span class="toc-number">1.</span> <span class="toc-text">What the password?</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#General-Info"><span class="toc-number">2.</span> <span class="toc-text">General Info</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Play-Time"><span class="toc-number">3.</span> <span class="toc-text">Play Time</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Name-Game"><span class="toc-number">4.</span> <span class="toc-text">Name Game</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Name-Game-2"><span class="toc-number">5.</span> <span class="toc-text">Name Game 2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Silly-Rick"><span class="toc-number">6.</span> <span class="toc-text">Silly Rick</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hide-And-Seek"><span class="toc-number">7.</span> <span class="toc-text">Hide And Seek</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Path-To-Glory"><span class="toc-number">8.</span> <span class="toc-text">Path To Glory</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Path-To-Glory-2"><span class="toc-number">9.</span> <span class="toc-text">Path To Glory 2</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Bit-4-Bit"><span class="toc-number">10.</span> <span class="toc-text">Bit 4 Bit</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Graphic%E2%80%99s-For-The-Weak"><span class="toc-number">11.</span> <span class="toc-text">Graphic’s For The Weak</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Recovery"><span class="toc-number">12.</span> <span class="toc-text">Recovery</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Closure"><span class="toc-number">13.</span> <span class="toc-text">Closure</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/06/12/login-game/" title="忙里偷闲做一道Web题"><img src="https://s2.loli.net/2022/06/06/nMFbpWGyN35ICVm.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="忙里偷闲做一道Web题"/></a><div class="content"><a class="title" href="/2022/06/12/login-game/" title="忙里偷闲做一道Web题">忙里偷闲做一道Web题</a><time datetime="2022-06-12T10:43:41.000Z" title="发表于 2022-06-12 18:43:41">2022-06-12</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/30/CISCN2022/" title="CISCN2022 初赛"><img src="https://s2.loli.net/2022/06/06/NRPCUlQtxn7BzAc.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CISCN2022 初赛"/></a><div class="content"><a class="title" href="/2022/05/30/CISCN2022/" title="CISCN2022 初赛">CISCN2022 初赛</a><time datetime="2022-05-30T07:33:02.000Z" title="发表于 2022-05-30 15:33:02">2022-05-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/15/otterctf/" title="OtterCTF 内存取证"><img src="https://s2.loli.net/2022/06/06/MVU3yA5KrjLHpth.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="OtterCTF 内存取证"/></a><div class="content"><a class="title" href="/2022/05/15/otterctf/" title="OtterCTF 内存取证">OtterCTF 内存取证</a><time datetime="2022-05-15T07:19:39.000Z" title="发表于 2022-05-15 15:19:39">2022-05-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/13/pwnhub5/" title="PWNHUB 5月公开赛 Web"><img src="https://s2.loli.net/2022/06/06/Pszmq3Fd6QyGNlj.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PWNHUB 5月公开赛 Web"/></a><div class="content"><a class="title" href="/2022/05/13/pwnhub5/" title="PWNHUB 5月公开赛 Web">PWNHUB 5月公开赛 Web</a><time datetime="2022-05-13T06:46:37.000Z" title="发表于 2022-05-13 14:46:37">2022-05-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/05/10/aes/" title="AES加密算法逆向分析"><img src="https://s2.loli.net/2022/06/06/NZy8HvYqgXoVu4a.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AES加密算法逆向分析"/></a><div class="content"><a class="title" href="/2022/05/10/aes/" title="AES加密算法逆向分析">AES加密算法逆向分析</a><time datetime="2022-05-10T12:35:26.000Z" title="发表于 2022-05-10 20:35:26">2022-05-10</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://s2.loli.net/2022/06/06/MVU3yA5KrjLHpth.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2021 - 2022 By A.R.</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">Steins ; Gate</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://jsdelivr.pai233.top/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"></div><script defer="defer" id="ribbon" src="https://jsdelivr.pai233.top/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>